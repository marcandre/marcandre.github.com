
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title># Hash</title>
  <meta name="author" content="Marc-André Lafortune">

  
  <meta name="description" content="tl;dnr While I really appreciate the constructive comments I get on pull requests I make, there’s one type of comment I have a hard time with. Please &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.marc-andre.ca/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="# Hash" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">$.noConflict();</script>
<script src="/javascripts/custom.js"></script>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-38685279-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/"><img alt="# hash" height="166px; " id="Header1_headerimg" src="http://2.bp.blogspot.com/_IXKt6zPbC7g/SdujkTMXpzI/AAAAAAAAABU/2AsMA3fytvQ/S1600-R/header.jpg" style="display: block" width="985px; "></a></h1>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.marc-andre.ca" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/02/05/why-i-wont-squash-my-commits/">Why I Won&#8217;t Squash My Commits</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-05T00:27:00-05:00" pubdate data-updated="true">Feb 5<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>tl;dnr</h2>

<p>While I really appreciate the constructive comments I get on pull requests I make, there’s one type of comment I have a hard time with.</p>

<p>Please don&#8217;t <a href="https://github.com/rails/rails/pull/8267#issuecomment-11551706">ask me</a>
 to <a href="https://github.com/rails/rails/pull/13938#issuecomment-34061339">squash</a>
 the commits of my pull requests.</p>

<p>I won’t.</p>

<p>If my pull request has 5 commits, it is because I each of them is independent and I believe they should remain so.</p>

<p>Project committers have a couple of choices:</p>

<ul>
<li>merge the PR as is</li>
<li>manually squash the commits</li>
<li>wait for someone else to make a PR with the commits squashed</li>
<li>reject the PR</li>
</ul>


<p>Call it lunacy or pride, but I just won’t squash my commits. Hopefully committers won’t take offense at that as I’ll do my best to not take offense at their suggestion that I didn’t segment my commits correctly.</p>

<h2>Why committers ask to squash commits?</h2>

<p>I imagine the historical reason it that many contributors aren&#8217;t super comfortable with <code>git</code> and <code>git rebase -i</code> in particular, so their commits represent their train of thought, not a sequence of independent changes to apply. E.g.:</p>

<ul>
<li>Introduce &lt;great feature&gt;</li>
<li>Oops, fix typo</li>
<li>Oh oh, fix a bug of &lt;great feature&gt;</li>
<li>Fix bug of &lt;great feature&gt; (for real this time)</li>
</ul>


<p>For these contributors, it is mandatory that the commits are not accepted as is. Squashing the whole thing is usually the safest bet.</p>

<p>There are many contributors that use <code>git rebase -i</code> and <code>git commit -p</code> in their sleep though, so that won’t be the situation.</p>

<p>The other reason I’ve been told is that &#8220;we generally squash all commits so that it&#8217;s easy to backport/revert”. I can&#8217;t agree with that. First, it is much more difficult to backport/revert just part of the PR if it is squashed. Morever, it’s pretty easy to backport/revert the whole PR by using <code>git revert</code> and <code>git cherry-pick</code> either with a range of commits or the merge commit. Less than 2% of commits get reverted anyways.</p>

<h2>When should committers not ask to squash commits?</h2>

<p>If all commits can stand on their own, i.e. all tests pass after each individual commit, then the commits are atomic and do not need to be squashed. I’d even say they probably shouldn’t be squashed.</p>

<p>My commits are typically the smallest unit of change that will work and still pass all tests.
The main exception is a commit of a bunch of trivial changes that are isolated (e.g. removing trailing whitespace, fixing a bunch of typos in the doc,renaming of a local variable). Even then, I won’t commit doc typos and renaming of a variable together, say.</p>

<p>When doing a refactor, I will usually split the changes in small independent refactoring commits. I believe it makes it easier to understand and judge than one big commit.</p>

<p>A rather telling example was <a href="https://github.com/sdsykes/fastimage/pull/27">this PR I made recently</a>. It aims at fixing one bug, but I broke it down into 15 commits. Each consists of a single refactoring step in the right direction, until the last commit which is the one fixing the bug per say. It&#8217;s easier to see the validity of each change this way, while the combined diff has a lot of noise and does a bunch of different things at once. I just can’t grok the combined diff.</p>

<p>I&#8217;m not asking everyone to structure their commits with such detail and attention; I&#8217;m only asking that it be, if not appreciated, at least accepted to do so.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/03/23/method-lookup-in-ruby-20/">Method Lookup in Ruby 2.0.0</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-23T00:27:00-04:00" pubdate data-updated="true">Mar 23<span>rd</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Tech.pro sponsored a tutorial on method lookup in Ruby 2.0.0.</p>

<p>It&#8217;s an in-depth review of how exactly Ruby deals with method calls.</p>

<p><footer>
  <a rel="full-article" href="http://tech.pro/tutorial/1149/understanding-method-lookup-in-ruby-20">Read on →</a>
</footer></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2013/02/23/ruby-2-by-example/">Ruby 2.0.0 by Example</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-23T07:40:00-05:00" pubdate data-updated="true">Feb 23<span>rd</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There&#8217;s a <a href="http://rrmartins.github.com/blog/2013/02/26/traducao-ruby-2-dot-0-por-exemplos/">Portugese translation</a>  by Rodrigo Martins if you prefer.</p>

<p>A quick summary of some of the new features of Ruby 2.0.0</div>
  
  
    <footer>
      <a rel="full-article" href="/2013/02/23/ruby-2-by-example/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2011/04/25/dry-migrations/">DRY Migrations</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-04-25T00:00:00-04:00" pubdate data-updated="true">Apr 25<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I wanted to write a post about the many things that should be fixed with Rails.</p>

<p>Interestingly, Rails 3.1 fixes quite many of these.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2011/04/25/dry-migrations/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/11/15/methodmissing-politely/">Method_missing, Politely</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-11-15T00:00:00-05:00" pubdate data-updated="true">Nov 15<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In their <a href="politeprogrammer.com/blog.html">Polite Programmer</a> talk at Rubyconf, Jim Weirich and Chris Nelson pointed out that merely adding some behavior with <code>method_missing</code> wasn&#8217;t quite polite, as shown below:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">StereoPlayer</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">method_missing</span><span class="p">(</span><span class="nb">method</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="nb">method</span><span class="o">.</span><span class="n">to_s</span> <span class="o">=~</span> <span class="sr">/play_(\w+)/</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;Here&#39;s </span><span class="si">#{</span><span class="vg">$1</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="k">super</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="nb">p</span> <span class="o">=</span> <span class="no">StereoPlayer</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="c1"># ok:</span>
</span><span class='line'><span class="nb">p</span><span class="o">.</span><span class="n">play_some_Beethoven</span> <span class="c1"># =&gt; &quot;Here&#39;s some_Beethoven&quot;</span>
</span><span class='line'><span class="c1"># not very polite:</span>
</span><span class='line'><span class="nb">p</span><span class="o">.</span><span class="n">respond_to?</span> <span class="ss">:play_some_Beethoven</span> <span class="c1"># =&gt; false</span>
</span></code></pre></td></tr></table></div></figure>


<p>In order for <code>respond_to?</code> to return <code>true</code>, one can specialize it</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/11/15/methodmissing-politely/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2010/04/01/fixing-mri-dozen-steps-at-time/">Fixing MRI, a Dozen Steps at a Time</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-01T00:00:00-04:00" pubdate data-updated="true">Apr 1<span>st</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Is there a term like bugfield? You know, when everytime you get to take a couple of steps in a code base you encounter a different bug, which leads to another one, &#8230;, like a minefield of bugs?</p>

<p>Here was my last sequence in Ruby (MRI)&#8230;</p>

<p>Main goal: improve <code>Matrix#determinant</code> and <code>#rank</code> after a <a href="http://redmine.ruby-lang.org/issues/show/2772">suggestion of Yu Ichino</a>. The bulk of the work took me quite a while, as I had to check a bunch of things, understand the algorithm, do some performance testing, etc&#8230;</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2010/04/01/fixing-mri-dozen-steps-at-time/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/09/01/best-time-to-get-involved-in-ruby-core/">Best Time to Get Involved in Ruby Core</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-09-01T00:00:00-04:00" pubdate data-updated="true">Sep 1<span>st</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Apart from enjoying the summer, I&#8217;ve spent time hacking on MRI, especially since I&#8217;ve been accepted as a committer. The feature freeze for Ruby 1.9.2 was planned for yesterday and this has been pushed back a couple of days before. Rejoice!</p>

<p>Why? </div>
  
  
    <footer>
      <a rel="full-article" href="/2009/09/01/best-time-to-get-involved-in-ruby-core/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/06/01/stickler-in-silicon-valley/">Stickler in Silicon Valley</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-06-01T00:00:00-04:00" pubdate data-updated="true">Jun 1<span>st</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I have not been actively looking for a job yet. Nevertheless, I was contacted by a startup and invited to spend a week in Silicon Valley / San Francisco, hacking around with them to see if I could become part of their team, which I found quite flattering. I learned lots of new things in California. A couple of new words too. I&#8217;m still unsure as to what exactly a hipster is, but &#8220;stickler&#8221; was easier to grasp: one who insists on exactness or completeness in the observance of something.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2009/06/01/stickler-in-silicon-valley/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/05/02/schizo-ruby-puzzle/">A Schizo Ruby Puzzle</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-02T00:00:00-04:00" pubdate data-updated="true">May 2<span>nd</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Quick quirky quiz (schizo version)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Without writing any method/block/lambda,</span>
</span><span class='line'><span class="c1"># can you find ways to obtain, in Ruby 1.8.7 or 1.9:</span>
</span><span class='line'><span class="n">x</span> <span class="o">==</span> <span class="n">y</span>   <span class="c1"># ==&gt; true</span>
</span><span class='line'><span class="n">y</span> <span class="o">==</span> <span class="n">x</span>   <span class="c1"># ==&gt; false</span>
</span></code></pre></td></tr></table></div></figure>


<p>Here&#8217;s how I got to checkout Ruby&#8217;s source and stumble upon that.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/2009/05/02/schizo-ruby-puzzle/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2009/05/01/lost-in-recursion/">Lost in Recursion</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-05-01T00:00:00-04:00" pubdate data-updated="true">May 1<span>st</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last time I asked a simple (but quite hard) Ruby quiz:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Without writing any method/block/lambda,</span>
</span><span class='line'><span class="c1"># can you find ways to obtain, in Ruby 1.8.7 or 1.9:</span>
</span><span class='line'><span class="n">x</span> <span class="o">==</span> <span class="n">y</span>   <span class="c1"># ==&gt; true</span>
</span><span class='line'><span class="n">y</span> <span class="o">==</span> <span class="n">x</span>   <span class="c1"># ==&gt; false</span>
</span></code></pre></td></tr></table></div></figure>




</div>
  
  
    <footer>
      <a rel="full-article" href="/2009/05/01/lost-in-recursion/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
<h1>I ♥ Ruby!</h1>
<div class="bio">
I&#8217;m a committer on Ruby (MRI) and contributer to many other projects, including some of my own:
<ul class="projects">
<li><a href="https://github.com/marcandre/backports">backports</a>: today&#8217;s Ruby in yesterday&#8217;s implementations.</li>
<li><a href="https://github.com/marcandre/scheherazade">scheherazade</a>: clever and sexy fixture factory.</li>
<li><a href="https://github.com/marcandre/fruity">fruity</a>: easy micro-benchmarking.</li>

<div style="margin-top: 5px">
<a class="FlattrButton" style="display:none;" rev="flattr;button:compact;" href="http://blog.marc-andre.ca"></a>
<noscript><a href="http://flattr.com/thing/1177153/Hash" target="_blank">
<img src="http://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this" border="0" /></a></noscript>
</div>

</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2014/02/05/why-i-wont-squash-my-commits/">Why I won&#8217;t squash my commits</a>
      </li>
    
      <li class="post">
        <a href="/2013/03/23/method-lookup-in-ruby-20/">Method lookup in Ruby 2.0.0</a>
      </li>
    
      <li class="post">
        <a href="/2013/02/23/ruby-2-by-example/">Ruby 2.0.0 by example</a>
      </li>
    
      <li class="post">
        <a href="/2011/04/25/dry-migrations/">DRY migrations</a>
      </li>
    
      <li class="post">
        <a href="/2010/11/15/methodmissing-politely/">method_missing, politely</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("malafortune", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/malafortune" class="twitter-follow-button" data-show-count="false">Follow @malafortune</a>
  
</section>


<section>
  <h1>on the Internets</h1>
  <ul>
    <li><script type="text/javascript">eval(decodeURIComponent('%64%6f%63%75%6d%65%6e%74%2e%77%72%69%74%65%28%27%3c%61%20%68%72%65%66%3d%22%6d%61%69%6c%74%6f%3a%62%6c%6f%67%40%6d%61%72%63%2d%61%6e%64%72%65%2e%63%61%22%3e%62%6c%6f%67%40%6d%61%72%63%2d%61%6e%64%72%65%2e%63%61%3c%2f%61%3e%27%29%3b'))</script></li>
    <li><a href="https://github.com/marcandre">Github</a></li>
    <li><a href="http://stackoverflow.com/users/8279/marc-andre-lafortune">StackOverflow</a></li>
    <li>#freenode: marcandre</li>
  </ul>
</section>


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/113114279421763230783?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - Marc-André Lafortune -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'marc-andre';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
